<!DOCTYPE html>
<html>
<head>
    <title>My Haushaltsplan Form</title>
</head>
<body>
    <h1>Create Haushaltsplan</h1>

    <!-- create_form.html -->
<form method="post">
  {% csrf_token %}

  <!-- Haushaltsplan Form -->
  {{ haushaltsplan_form.as_p }}

  <!-- Haushaltsposten Formset -->
  {% for form in haushaltsposten_formset %}
    {{ form.as_table }}
    <hr>
  {% endfor %}

  <!-- Projekt Formset -->
  {% for form in projekt_formset %}
    {{ form.as_table }}
    <hr>
  {% endfor %}

  <!-- Aufwand Formset -->
  {% for form in aufwand_formset %}
    {{ form.as_table }}
    <hr>
  {% endfor %}

  <input type="submit" value="Submit">
</form>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // Add new Haushaltsposten form
            $('.add-haushaltsposten').click(function() {
                var haushaltspostenForm = $('.haushaltsposten-form:last').clone(true);
                haushaltspostenForm.find(':input').val('');
                haushaltspostenForm.find('.projekt-form').remove();
                haushaltspostenForm.find('.add-projekt').attr('disabled', false);
                haushaltspostenForm.find('.add-aufwand').attr('disabled', true);
                haushaltspostenForm.insertAfter('.haushaltsposten-form:last');
            });

            // Add new Projekt form
            $(document).on('click', '.add-projekt', function() {
                var projektForm = $(this).closest('.haushaltsposten-form').find('.projekt-form:last').clone(true);
                projektForm.find(':input').val('');
                projektForm.find('.aufwand-form').remove();
                projektForm.find('.add-aufwand').attr('disabled', false);
                projektForm.insertAfter($(this).closest('.haushaltsposten-form').find('.projekt-form:last'));
            });

            // Add new Aufwand form
            $(document).on('click', '.add-aufwand', function() {
                var aufwandForm = $(this).closest('.projekt-form').find('.aufwand-form:last').clone(true);
                aufwandForm.find(':input').val('');
                aufwandForm.insertAfter($(this).closest('.projekt-form').find('.aufwand-form:last'));
            });
        });
    </script>
</body>
</html>
